<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Details</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300..700&family=Red+Hat+Display:ital,wght@0,300..900;1,300..900&family=Rufina:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
<div class="main">
    <div id="content">
        <div id="hero" style="background-image: url('pics/greenbubble.jpg');">
            <div class="shader">
                <a href="main.html"><h1>Green Statistic AB</h1></a>
                <a href="main.html"><h4>The green way forward</h4></a>
            </div>  
        </div>

        <div id="central">
            <div class="focus">
                <div class="movie-info" id="movieInfo">
                    <!-- Dynamic content will be inserted here -->
                </div>  
            </div>

            <div class="movie-stats">
                <div class="statsinfo" id="statsInfo">
                    <h2>How do we get these stats?</h2>
                    <ul>
                        <li>The IMDB score is calculated by:</li>
                        <i>IMDB score * 10</i><hr>

                        <li>The bechdel test is determined by yes or no</li>
                        <i>Bechdel score is either 0 or 100</i><hr>

                        <li>And the top 250 IMDB is calculated through</li>
                        <i>100 - ((movie ranking / 250) * 100); Convert to inverse percentage</i><hr>

                        <li>All stats are sourced from our database</li>
                        <i>With data from our two sources bechdel, and IMDB</i>
                    </ul>
                </div>
                <canvas id="barChart"></canvas>
            </div>
        </div>
        
        <footer>
            <div class="footer-description">
                 <h3>Social Media</h3>
                     <div class="certific">
                        <a href="https://www.instagram.com"> <img src="pics/instagram.png" alt="instagram"></a>
                        <a href="https://x.com"> <img src="pics/twitter.webp" alt="twitter"></a>
                        <a href="https://www.facebook.com"> <img src="pics/facebook.png" alt="facebook"></a>
                    </div>
            </div>
            <div class="footer-contact">
                <h3>Contact Us</h3>
                <a href="kontakt.html" class="contact-button">Here!</a>
            </div>
            <div class="footer-policy">
                <a href="policy.html">Integrtity policy</a>
             </div>  
             <div class="copyright"><h4>â’¸ 2025 Green Statistic AB. All rights reserved.</h4></div>  
        </footer> 
    </div> 
</div>
<script>
// Load movie data from storage
document.addEventListener('DOMContentLoaded', () => {
    const movieData = JSON.parse(sessionStorage.getItem('currentMovie'));
    
    if (!movieData) {
        window.location.href = 'index.html';
        return;
    }

    // Update movie info section
    const movieInfo = document.getElementById('movieInfo');
    movieInfo.innerHTML = `
        <div class="infocontainer">
            <h2>${movieData.title} (${movieData.year})</h2>
            <p>Rating: ${movieData.rating}/10</p>
            ${movieData.bechdel ? `<p>Bechdel Test: Passed</p>` : `<p>Bechdel Test: Not Passed</p>`}
        </div>
    `;

    // Update chart with movie-specific data
    updateChart(movieData);
});

function updateChart(movie) {
    const ctx = document.getElementById('barChart').getContext('2d');
    
    // Convert data to appropriate scales
    const ratingPercentage = movie.rating * 10; // 0-100 scale
    const bechdelScore = movie.bechdel ? 100 : 0; // 0 or 100
    const top250Position = 100 - ((movie.id / 250) * 100); // Convert to inverse percentage (higher rank = better)
    
    new Chart(ctx, {
        type: 'radar',
        data: {
            labels: ['IMDB Rating', 'Bechdel Test', 'Top250 Rank'],
            datasets: [{
                label: movie.title,
                data: [ratingPercentage, bechdelScore, top250Position],
                backgroundColor: 'rgba(91, 169, 109, 0.4)',
                borderColor: 'rgba(91, 169, 109, 1)',
                pointBackgroundColor: 'rgba(91, 169, 109, 1)',
                pointBorderColor: '#fff',
                pointHoverRadius: 5,
                pointHoverBackgroundColor: 'rgba(91, 169, 109, 1)',
                pointHoverBorderColor: '#fff',
                pointHitRadius: 10,
                pointBorderWidth: 2,
                borderWidth: 2
            }]
        },
        options: {
            responsive: true,
            scales: {
                r: {
                    angleLines: {
                        color: 'rgba(255, 255, 255, 0.2)'
                    },
                    grid: {
                        color: 'rgba(255, 255, 255, 0.2)'
                    },
                    pointLabels: {
                        color: 'white',
                        font: {
                            family: 'var(--text-font)'
                        }
                    },
                    min: 0,
                    max: 100,
                    ticks: {
                        backdropColor: 'transparent',
                        color: 'white',
                        stepSize: 20
                    }
                }
            },
            plugins: {
                legend: {
                    labels: {
                        color: 'white',
                        font: {
                            family: 'var(--text-font)'
                        }
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed.r !== null) {
                                switch(context.label) {
                                    case 'IMDB Rating':
                                        return label + movie.rating + '/10';
                                    case 'Bechdel Test':
                                        return label + (movie.bechdel ? 'Passed' : 'Failed');
                                    case 'Top250 Rank':
                                        return label + '#' + movie.id;
                                }
                            }
                            return label;
                        }
                    }
                }
            }
        }
    });
}
</script>
</body>
</html>